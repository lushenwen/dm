<!doctype html>
<html>
	<head>
		<title>Document</title>
		<meta charset="UTF-8">
	</head>
	<body onload="sel()">
		<div>
		用户名称：<input type="text" id="dname">
	</div>
	<div>
		用户密码：<input type="text" id="upwd">
	</div>
	<div>
		用户邮箱：<input type="text" id="email">
	</div>
	<div>
		联系方式：<input type="text" id="phone">
	</div>
	<div>
		真实姓名：<input type="text" id="user_name">
	</div>
	<div>
		用户性别：<input type="radio" id="g_man" name="gender" value="1">男
		<input type="radio" id="g_woman" name="gender" value="0">女
		<button onclick="update()">修改</button>
	</div>
	<script>
		var urlParams=new URLSearchParams(location.search);
		var uid=urlParams.get("uid");
		function sel(){
			var xhr=new XMLHttpRequest();
			xhr.onreadystatechange=function(){
				if(xhr.readyState==4&&xhr.status==200){
					var result=xhr.responseText;
					var arr=JSON.parse(result);
					dname.value=arr.dname;
					upwd.value=arr.upwd;
					email.value=arr.value;
					phone.value=arr.value;
					user_name.value=arr.user_name;
					if(arr.gender==1){
						g_man.checked=true;
					}else if(arr.gender==0){
						g_woman.checked=true;
					}
				};
			}
			xhr.open("get","/user/sel?uid="+uid,true);
			xhr.send();
		}
		function update(){
			var xhr=new XMLHttpRequest();
			xhr.onreadystatechange=function(){
				if(xhr.readyState==4&&xhr.status==200){
					var result=xhr.responseText;
					alert(result);
				}
			};
			xhr.open("post","/user/update",true);
			xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
			var gender_v="";
			if(g_man.checked){
				gender_v="1";
			}else{
				gender_v="0";
			}
			var formdata="dname="+dname.value+"&upwd="+upwd.value+"&email="+email.value+"&phone="+phone.value+"&user_name="+user_name.value+"&gender="+gender_v+"&uid="+uid;
			xhr.send(formdata);
		}
	</script>
	</body>
</html>